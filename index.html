<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Basic VR Space - Oculus 2 Controllers</title>
    <meta name="description" content="VR Space with Oculus 2 Controller Support">
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
</head>
<body>
    <a-scene 
        vr-mode-ui="enabled: true" 
        embedded
        style="height: 100vh; width: 100vw;"
        background="color: #87CEEB">
        
        <!-- Assets -->
        <a-assets>
            <!-- Define colors for interaction -->
        </a-assets>

        <!-- Lighting -->
        <a-light type="ambient" color="#404040"></a-light>
        <a-light type="directional" position="0 10 5" color="#ffffff" intensity="0.8"></a-light>

        <!-- Sky -->
        <a-sky color="#87CEEB"></a-sky>

        <!-- Floor -->
        <a-plane 
            position="0 0 0" 
            rotation="-90 0 0" 
            width="20" 
            height="20" 
            color="#7BC043" 
            shadow="receive: true">
        </a-plane>

        <!-- Interactive 3D Objects -->
        <!-- Red Box -->
        <a-box 
            id="box1"
            position="-3 1 -5" 
            color="#FF4444" 
            shadow="cast: true"
            class="clickable"
            animation__mouseenter="property: scale; to: 1.1 1.1 1.1; startEvents: mouseenter; dur: 200"
            animation__mouseleave="property: scale; to: 1 1 1; startEvents: mouseleave; dur: 200">
        </a-box>

        <!-- Blue Sphere -->
        <a-sphere 
            id="sphere1"
            position="0 1.5 -5" 
            radius="0.8"
            color="#4444FF" 
            shadow="cast: true"
            class="clickable"
            animation__mouseenter="property: scale; to: 1.1 1.1 1.1; startEvents: mouseenter; dur: 200"
            animation__mouseleave="property: scale; to: 1 1 1; startEvents: mouseleave; dur: 200">
        </a-sphere>

        <!-- Green Cylinder -->
        <a-cylinder 
            id="cylinder1"
            position="3 1 -5" 
            radius="0.8"
            height="2"
            color="#44FF44" 
            shadow="cast: true"
            class="clickable"
            animation__mouseenter="property: scale; to: 1.1 1.1 1.1; startEvents: mouseenter; dur: 200"
            animation__mouseleave="property: scale; to: 1 1 1; startEvents: mouseleave; dur: 200">
        </a-cylinder>

        <!-- Yellow Torus (Donut shape) -->
        <a-torus 
            id="torus1"
            position="-1.5 2 -3" 
            color="#FFFF44" 
            radius="0.8"
            radius-tubular="0.2"
            shadow="cast: true"
            class="clickable"
            animation__mouseenter="property: scale; to: 1.1 1.1 1.1; startEvents: mouseenter; dur: 200"
            animation__mouseleave="property: scale; to: 1 1 1; startEvents: mouseleave; dur: 200">
        </a-torus>

        <!-- Purple Dodecahedron -->
        <a-dodecahedron 
            id="dodeca1"
            position="1.5 1.5 -3" 
            color="#FF44FF" 
            radius="0.8"
            shadow="cast: true"
            class="clickable"
            animation__mouseenter="property: scale; to: 1.1 1.1 1.1; startEvents: mouseenter; dur: 200"
            animation__mouseleave="property: scale; to: 1 1 1; startEvents: mouseleave; dur: 200">
        </a-dodecahedron>

        <!-- VR Camera with Controller Support -->
        <a-entity 
            id="rig" 
            movement-controls="fly: false; constrainToNavMesh: false"
            position="0 1.6 0">
            
            <!-- Camera -->
            <a-camera 
                id="head" 
                position="0 0 0"
                look-controls="pointerLockEnabled: true"
                wasd-controls="enabled: false">
            </a-camera>

            <!-- Left Hand Controller (Movement) -->
            <a-entity 
                id="leftHand"
                oculus-touch-controls="hand: left"
                thumbstick-logging>
            </a-entity>

            <!-- Right Hand Controller (Pointing and Clicking) -->
            <a-entity 
                id="rightHand"
                oculus-touch-controls="hand: right"
                laser-controls="showLine: true; defaultColor: #FF0000; hitColor: #00FF00"
                raycaster="objects: .clickable; far: 20; interval: 200"
                line="color: red; opacity: 0.8"
                cursor="rayOrigin: entity">
            </a-entity>
        </a-entity>

        <!-- Info Text -->
        <a-text 
            position="0 3 -4" 
            value="VR Space Ready!\nUse left thumbstick to move\nPoint with right controller and pull trigger to interact"
            color="white"
            align="center"
            width="8">
        </a-text>
    </a-scene>

    <script>
        // Component for thumbstick movement logging (optional - for debugging)
        AFRAME.registerComponent('thumbstick-logging', {
            init: function () {
                this.el.addEventListener('thumbstickmoved', function (evt) {
                    // Optional: Log thumbstick movement for debugging
                    // console.log('Thumbstick moved:', evt.detail);
                });
            }
        });

        // Enhanced click interaction component
        AFRAME.registerComponent('clickable-interaction', {
            init: function () {
                var el = this.el;
                var originalColor = el.getAttribute('color');
                var colors = ['#FF0000', '#00FF00', '#0000FF', '#FFFF00', '#FF00FF', '#00FFFF', '#FFA500'];
                var colorIndex = 0;

                el.addEventListener('click', function () {
                    // Cycle through colors on click
                    colorIndex = (colorIndex + 1) % colors.length;
                    el.setAttribute('color', colors[colorIndex]);
                    
                    // Add a brief scale animation for feedback
                    el.emit('click-feedback');
                });

                // Reset to original color on long hover
                el.addEventListener('mouseleave', function () {
                    setTimeout(() => {
                        if (colorIndex === 0) {
                            el.setAttribute('color', originalColor);
                        }
                    }, 2000);
                });
            }
        });

        // Apply the clickable interaction to all clickable objects
        document.addEventListener('DOMContentLoaded', function() {
            var clickables = document.querySelectorAll('.clickable');
            clickables.forEach(function(el) {
                el.setAttribute('clickable-interaction', '');
                // Add click feedback animation
                el.setAttribute('animation__click', 'property: scale; to: 1.3 1.3 1.3; dur: 100; startEvents: click-feedback');
                el.setAttribute('animation__clickback', 'property: scale; to: 1 1 1; dur: 100; startEvents: click-feedback; delay: 100');
            });
        });

        // Add some console logging for VR events
        document.querySelector('a-scene').addEventListener('enter-vr', function () {
            console.log('Entered VR mode');
        });

        document.querySelector('a-scene').addEventListener('exit-vr', function () {
            console.log('Exited VR mode');
        });
    </script>

    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
        }
        
        /* Ensure full screen coverage */
        html, body {
            height: 100%;
            overflow: hidden;
        }
    </style>
</body>
</html>